var app=angular.module("myApp",["ngRoute"]);app.config(["$routeProvider",function(e){e.when("/selected",{templateUrl:"html/selected.html",controller:"selectedCtrl"}).when("/all",{templateUrl:"html/all.html",controller:"allCtrl"}).when("/addNew",{templateUrl:"html/addNew.html",controller:"addNewCtrl"}).otherwise({redirectTo:"/selected"})}]),app.service("ajaxService",function(){var e="https://www.easy-mock.com/mock/5b88b7ab76b79510db91766a/example",l=e+"/questionBank/1";this.querySelected=function(){return l};var t=e+"/questionBank/0";this.queryNotSelected=function(){return t};var a=e+"/questionBank/2";this.queryAll=function(){return a};var n=e+"/xxx";this.addQuestion=function(){return n};var o=e+"/xxx";this.deleteQuestions=function(){return o};var r=e+"/xxx";this.moveQuestions=function(){return r};var s=e+"/xxx";this.updateQuestion=function(){return s}}),app.run(["$rootScope","ajaxService","$http","$timeout",function(e,l,t,a){e.var_common_appDownloadShow=!1,e.var_selectedNumber=0,e.var_allNumber=0,e.selectedData=[],e.allData=[],e.fn_checkLogin=function(){var e=window.location.hash;e.indexOf("login")>0||null!=localStorage.getItem("username")&&""!==localStorage.getItem("username")||(window.location.href="html/login.html#login")},e.fn_checkLogin(),e.fn_logout=function(){localStorage.clear(),window.location.href="html/login.html#login"},e.fn_checkPage=function(){console.log("111111111");var e=window.location.hash;console.log(e);var l=document.getElementById("sidebar-menu").children[0].children;"#/selected"===e?(angular.element(l[0].children[0]).addClass("active"),angular.element(l[1].children[0]).removeClass("active"),angular.element(l[2].children[0]).removeClass("active"),angular.element(l[3].children[0]).removeClass("active")):"#/all"===e?(angular.element(l[0].children[0]).removeClass("active"),angular.element(l[1].children[0]).addClass("active"),angular.element(l[2].children[0]).removeClass("active"),angular.element(l[3].children[0]).removeClass("active")):"#/addNew"===e&&(angular.element(l[0].children[0]).removeClass("active"),angular.element(l[1].children[0]).removeClass("active"),angular.element(l[2].children[0]).addClass("active"),angular.element(l[3].children[0]).removeClass("active"))},e.fn_preloader=function(){var e=document.getElementById("preloader");angular.element(e).addClass("loading_comment"),setTimeout(function(){e.style.display="none"},1300)},e.fn_preloader(),e.fn_button_popovers=function(){$('[data-toggle="popover"]').popover()},e.fn_getQuestionsNumber=function(a){var n=-1;n=a;var o="";if(0===n)o=l.querySelected();else{if(1!==n)return;o=l.queryAll()}t({method:"get",url:o,headers:{"Content-Type":"application/json"}}).success(function(l){0!==l.length&&(0===a?(e.var_selectedNumber=l.diffcultQuestions.length+l.commonQuestions.length+l.simpleQuestions.length,e.selectedData=[l.diffcultQuestions.length,l.commonQuestions.length,l.simpleQuestions.length],console.log("selected scope selectedNumber:"+e.var_selectedNumber)):1===a&&(e.var_allNumber=l.diffcultQuestions.length+l.commonQuestions.length+l.simpleQuestions.length,e.allData=[l.diffcultQuestions.length,l.commonQuestions.length,l.simpleQuestions.length],console.log("selected scope allNumber:"+e.var_allNumber)))}).error(function(e){})},e.fn_show_alertModel=function(l,t,a){var n=document.getElementById("myAlert");0===l?angular.element(n).addClass("alert-primary"):1===l?angular.element(n).addClass("alert-warning"):angular.element(n).addClass("alert-danger"),$("#exampleModal").modal("show"),e.alertMessage=t,setTimeout(function(){$("#exampleModal").modal("hide")},a)},e.alertMessage="",e.fn_close_alertModel=function(){$("#exampleModal").modal("hide")}}]),app.controller("loginCtrl",["$scope","$rootScope","$http","ajaxService",function(e,l,t,a){l.fn_preloader(),localStorage.clear(),e.username="admin",e.password="admin",e.alertText="",e.showAlert=function(l){console.log("1111"),e.alertText=l;var t=document.getElementById("showAlert");angular.element(t).hasClass("fade")&&(angular.element(t).removeClass("fade"),angular.element(t).addClass("show"),setTimeout(function(){angular.element(t).removeClass("show"),angular.element(t).addClass("fade")},3e3))},e.fn_login=function(){return""==e.username?void e.showAlert("请输入用户名！"):""==e.password?void e.showAlert("请输入密码！"):void("admin"!==e.username||"admin"!==e.password?e.showAlert("用户名或密码输入错误！"):(localStorage.setItem("username","root"),window.location.href="../index.html"))},e.loginKeyup=function(l){var t=window.event?l.keyCode:l.which;13==t&&e.fn_login()}}]),app.controller("selectedCtrl",["$scope","$rootScope","$http","ajaxService",function(e,l,t,a){l.fn_checkPage(),l.fn_getQuestionsNumber(1),e.arr_diffcultQuestions=[],e.arr_commonQuestions=[],e.arr_simpleQuestions=[],e.arr_selectedEasy=[],e.arr_finalSelectEasy=[],e.arr_selectedCom=[],e.arr_finalSelectCom=[],e.arr_selectedDiff=[],e.arr_finalSelectDiff=[],e.fn_getSelected=function(n){t({method:"get",url:a.querySelected(),headers:{"Content-Type":"application/json"}}).success(function(t){0!==t.length?(e.arr_diffcultQuestions=t.diffcultQuestions,e.arr_commonQuestions=t.commonQuestions,e.arr_simpleQuestions=t.simpleQuestions,l.var_selectedNumber=e.arr_diffcultQuestions.length+e.arr_commonQuestions.length+e.arr_simpleQuestions.length,console.log("selected scope selectedNumber:"+l.var_selectedNumber),setTimeout(function(){l.fn_button_popovers()},50),n&&l.fn_show_alertModel(0,"已选题目加载完成",1300)):n&&l.fn_show_alertModel(1,"题目获取失败，请稍后再试",1500)}).error(function(e){n&&l.fn_show_alertModel(2,"题目获取失败，请检查网络",1500)})},e.fn_getSelected(!0),e.fn_changeSelected=function(l){e.arr_finalSelectEasy=[],e.arr_finalSelectCom=[],e.arr_finalSelectDiff=[];var t=[];if(0===l){for(var a in e.arr_selectedEasy)e.arr_selectedEasy[a]&&t.push(e.arr_selectedEasy[a]);e.arr_finalSelectEasy=t,console.info(e.arr_finalSelectEasy)}else if(1===l){for(var a in e.arr_selectedCom)e.arr_selectedCom[a]&&t.push(e.arr_selectedCom[a]);e.arr_finalSelectCom=t,console.info(e.arr_finalSelectCom)}else{for(var a in e.arr_selectedDiff)e.arr_selectedDiff[a]&&t.push(e.arr_selectedDiff[a]);e.arr_finalSelectDiff=t,console.info(e.arr_finalSelectDiff)}},e.fn_removeQuestions=function(n){var o={questionIds:[],isSelect:0};return e.arr_finalSelectEasy===[]&&e.arr_finalSelectCom===[]&&e.arr_finalSelectDiff===[]?void l.fn_show_alertModel(1,"请勾选需要批量移出的题目",1300):(0===n?o.questionIds=e.arr_finalSelectEasy.map(Number):1===n?o.questionIds=e.arr_finalSelectCom.map(Number):2===n&&(o.questionIds=e.arr_finalSelectDiff.map(Number)),void t({method:"put",url:a.moveQuestions(),data:JSON.stringify(o),headers:{"Content-Type":"application/json"}}).success(function(t){0==t.errorCode?(console.log("移除 "+n+" 成功"),e.fn_getSelected(!1),l.fn_show_alertModel(0,"题目移出成功",1300)):(console.log("移除 "+n+" 失败"),l.fn_show_alertModel(1,"题目移出失败，请稍后重试",1300))}).error(function(e){console.log("移除 "+n+" 失败"),console.log(o.questionIds),l.fn_show_alertModel(2,"题目移出失败，请检查网络",1500)}))}}]),app.controller("allCtrl",["$scope","$rootScope","$http","ajaxService",function(e,l,t,a){l.fn_checkPage(),l.fn_getQuestionsNumber(0),e.arr_allDiffcultQuestions=[],e.arr_allCommonQuestions=[],e.arr_allSimpleQuestions=[],e.arr_allSelectedEasy=[],e.arr_allFinalSelectEasy=[],e.arr_allSelectedCom=[],e.arr_allFinalSelectCom=[],e.arr_allSelectedDiff=[],e.arr_allFinalSelectDiff=[],e.arr_allDeleteSelectedEasy=[],e.arr_allFinalDeleteSelectEasy=[],e.arr_allDeleteSelectedCom=[],e.arr_allFinalDeleteSelectCom=[],e.arr_allDeleteSelectedDiff=[],e.arr_allFinalDeleteSelectDiff=[],e.fn_getAll=function(n){t({method:"get",url:a.queryAll(),headers:{"Content-Type":"application/json"}}).success(function(t){0!==t.length?(e.arr_allDiffcultQuestions=t.diffcultQuestions,e.arr_allCommonQuestions=t.commonQuestions,e.arr_allSimpleQuestions=t.simpleQuestions,l.var_allNumber=e.arr_allDiffcultQuestions.length+e.arr_allCommonQuestions.length+e.arr_allSimpleQuestions.length,console.log("all scope allNumber:"+l.var_allNumber),l.fn_getQuestionsNumber(0),setTimeout(function(){l.fn_button_popovers()},50),n&&l.fn_show_alertModel(0,"全部题目获取成功",1300)):n&&l.fn_show_alertModel(1,"题目获取失败，请稍后重试",1300)}).error(function(e){n&&l.fn_show_alertModel(2,"题目获取失败，请检查网络",1500)})},e.fn_getAll(!0),e.fn_changeSelected=function(l){e.arr_allFinalSelectEasy=[],e.arr_allFinalSelectCom=[],e.arr_allFinalSelectDiff=[];var t=[];if(0===l){for(var a in e.arr_allSelectedEasy)e.arr_allSelectedEasy[a]&&t.push(e.arr_allSelectedEasy[a]);e.arr_allFinalSelectEasy=t,console.info(e.arr_allFinalSelectEasy)}else if(1===l){for(var a in e.arr_allSelectedCom)e.arr_allSelectedCom[a]&&t.push(e.arr_allSelectedCom[a]);e.arr_allFinalSelectCom=t,console.info(e.arr_allFinalSelectCom)}else{for(var a in e.arr_allSelectedDiff)e.arr_allSelectedDiff[a]&&t.push(e.arr_allSelectedDiff[a]);e.arr_allFinalSelectDiff=t,console.info(e.arr_allFinalSelectDiff)}},e.fn_deleteSelected=function(l){e.arr_allFinalDeleteSelectEasy=[],e.arr_allFinalDeleteSelectCom=[],e.arr_allFinalDeleteSelectDiff=[];var t=[];if(0===l){for(var a in e.arr_allDeleteSelectedEasy)e.arr_allDeleteSelectedEasy[a]&&t.push(e.arr_allDeleteSelectedEasy[a]);e.arr_allFinalDeleteSelectEasy=t,console.info(e.arr_allFinalDeleteSelectEasy)}else if(1===l){for(var a in e.arr_allDeleteSelectedCom)e.arr_allDeleteSelectedCom[a]&&t.push(e.arr_allDeleteSelectedCom[a]);e.arr_allFinalDeleteSelectCom=t,console.info(e.arr_allFinalDeleteSelectCom)}else{for(var a in e.arr_allFinalDeleteSelectDiff)e.arr_allFinalDeleteSelectDiff[a]&&t.push(e.arr_allFinalDeleteSelectDiff[a]);e.arr_allDeleteSelectedDiff=t,console.info(e.arr_allDeleteSelectedDiff)}},e.fn_removeQuestions=function(n){var o={questionIds:[],isSelect:1};return e.arr_allFinalSelectEasy===[]&&e.arr_allFinalSelectCom===[]&&e.arr_allFinalSelectDiff===[]?void l.fn_show_alertModel(1,"请选择需要移入的题目",1300):(0===n?o.questionIds=e.arr_allFinalSelectEasy.map(Number):1===n?o.questionIds=e.arr_allFinalSelectCom.map(Number):2===n&&(o.questionIds=e.arr_allFinalSelectDiff.map(Number)),void t({method:"put",url:a.moveQuestions(),data:JSON.stringify(o),headers:{"Content-Type":"application/json"}}).success(function(t){0==t.errorCode?(console.log("移入 "+n+" 成功"),e.fn_getAll(!1),l.fn_show_alertModel(0,"题目移入成功",1300)):(console.log("移入 "+n+" 失败"),l.fn_show_alertModel(1,"题目移入失败，请稍后重试",1300))}).error(function(e){console.log("移入 "+n+" 失败"),console.log(o.questionIds),l.fn_show_alertModel(2,"题目移入失败，请检查网络",1500)}))},e.fn_deleteQuestions=function(n){var o=[];return e.arr_allFinalDeleteSelectEasy===[]&&e.arr_allFinalDeleteSelectCom===[]&&e.arr_allFinalDeleteSelectDiff===[]?void l.fn_show_alertModel(1,"请选择需要删除的题目",1300):(0===n?o=e.arr_allFinalDeleteSelectEasy.map(Number):1===n?o=e.arr_allFinalDeleteSelectCom.map(Number):2===n&&(o=e.arr_allFinalDeleteSelectDiff.map(Number)),void t({method:"post",url:a.deleteQuestions(),data:JSON.stringify({questionIds:o}),headers:{"Content-Type":"application/json"}}).success(function(t){0==t.errorCode?(console.log("移入 "+n+" 成功"),e.fn_getAll(!1),l.fn_show_alertModel(0,"删除题目成功",1300)):(console.log("移入 "+n+" 失败"),l.fn_show_alertModel(1,"删除题目失败，请稍后重试",1300))}).error(function(e){console.log("移入 "+n+" 失败"),console.log(o),l.fn_show_alertModel(2,"删除题目失败，请检查网络",1500)}))},e.update_question={answerA:"",answerB:"",answerC:"",answerD:"",isRight:-1,isSelect:-1,questionLevel:-1,questionTitle:"",questionId:""},e.fn_getQuestionMessages=function(l){e.update_question.questionId=l.questionId,e.update_question.questionTitle=l.questionTitle,e.update_question.questionLevel=l.questionLevel,e.update_question.isSelect=l.isSelect,e.update_question.isRight=l.isRight,e.update_question.answerA=l.answerA,e.update_question.answerB=l.answerB,e.update_question.answerC=l.answerC,e.update_question.answerD=l.answerD},e.fn_updateQuestion=function(){return""===e.update_question.questionTitle?void l.fn_show_alertModel(1,"请输入题目名称",1300):""===e.update_question.answerA?void l.fn_show_alertModel(1,"请输入A选项",1300):""===e.update_question.answerB?void l.fn_show_alertModel(1,"请输入B选项",1300):""===e.update_question.answerC?void l.fn_show_alertModel(1,"请输入C选项",1300):""===e.update_question.answerD?void l.fn_show_alertModel(1,"请输入D选项",1300):void t({method:"put",url:a.updateQuestion(),data:JSON.stringify(e.update_question),headers:{"Content-Type":"application/json"}}).success(function(t){0==t.errorCode?(console.log("修改成功"),e.fn_getAll(!1),l.fn_show_alertModel(0,"修改题目成功",1300),e.fn_hide_updateModel()):(console.log("修改失败"),l.fn_show_alertModel(1,"修改题目失败，请稍后重试",1300))}).error(function(e){console.log("修改失败"),l.fn_show_alertModel(2,"修改题目失败，请检查网络",1500)})},e.fn_hide_updateModel=function(){$("#questionUpdateModal").modal("hide"),e.update_question={answerA:"",answerB:"",answerC:"",answerD:"",isRight:-1,isSelect:-1,questionLevel:-1,questionTitle:"",questionId:""}}}]),app.directive("commonLeftMenu",function(){return{restrict:"AE",replace:!0,templateUrl:"html/commonLeftMenu.html",scope:{selectedNumber:"=",allNumber:"="},controller:["$scope","$element",function(e,l){e.fn_go_page=function(e,l){e=e||window.event;var t=document.getElementById("sidebar-menu").children[0].children;0===l?(angular.element(t[0].children[0]).addClass("active"),angular.element(t[1].children[0]).removeClass("active"),angular.element(t[2].children[0]).removeClass("active"),angular.element(t[3].children[0]).removeClass("active"),window.location.href="#/selected"):1===l?(angular.element(t[0].children[0]).removeClass("active"),angular.element(t[1].children[0]).addClass("active"),angular.element(t[2].children[0]).removeClass("active"),angular.element(t[3].children[0]).removeClass("active"),window.location.href="#/all"):2===l?(angular.element(t[0].children[0]).removeClass("active"),angular.element(t[1].children[0]).removeClass("active"),angular.element(t[2].children[0]).addClass("active"),angular.element(t[3].children[0]).removeClass("active"),window.location.href="#/addNew"):3===l&&(angular.element(t[0].children[0]).removeClass("active"),angular.element(t[1].children[0]).removeClass("active"),angular.element(t[2].children[0]).removeClass("active"),angular.element(t[3].children[0]).addClass("active"),window.location.href="html/login.html#/login")}}]}}),app.controller("addNewCtrl",["$scope","$rootScope","$http","ajaxService",function(e,l,t,a){l.fn_checkPage(),l.fn_getQuestionsNumber(0),l.fn_getQuestionsNumber(1),e.add_question={answerA:"",answerB:"",answerC:"",answerD:"",isRight:0,isSelect:0,questionLevel:0,questionTitle:""},e.fn_addQuestion=function(){return""==e.add_question.questionTitle?void l.fn_show_alertModel(1,"请输入题目名称",1300):""==e.add_question.answerA?void l.fn_show_alertModel(1,"请输入A选项",1300):""==e.add_question.answerB?void l.fn_show_alertModel(1,"请输入B选项",1300):""==e.add_question.answerC?void l.fn_show_alertModel(1,"请输入C选项",1300):""==e.add_question.answerD?void l.fn_show_alertModel(1,"请输入D选项",1300):void t({method:"post",url:a.addQuestion(),data:JSON.stringify(e.add_question),headers:{"Content-Type":"application/json"}}).success(function(t){0==t.errorCode?(console.log("添加题目成功"),l.fn_getQuestionsNumber(0),l.fn_getQuestionsNumber(1),l.fn_show_alertModel(0,"新增题目成功",1300),e.add_question={answerA:"",answerB:"",answerC:"",answerD:"",isRight:0,isSelect:0,questionLevel:0,questionTitle:""}):(console.log("添加题目失败"),l.fn_show_alertModel(1,"新增题目失败，请稍后重试",1300))}).error(function(e){console.log("添加题目失败"),l.fn_show_alertModel(2,"新增题目失败，请检查网络",1300)})},e.fn_showEcharts=function(){var e=echarts.init(document.getElementById("bar-echarts")),t=echarts.init(document.getElementById("pie-echarts")),a={color:["#4c56e8","#72a2e8","#6084ee"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"},textStyle:{fontWeight:"bold",color:"#fff",fontSize:17}},legend:{data:["已选题目","全部题目"],textStyle:{color:"#6084ee",fontWeight:"bold",fontSize:15}},grid:{top:"8%",left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:["简单类型","中等类型","困难类型"],axisLine:{lineStyle:{color:"#4c56e8",width:2}},axisLabel:{fontSize:13,fontWeight:"bold"},axisTick:{show:!1}}],yAxis:[{type:"value",axisLine:{lineStyle:{color:"#4c56e8",width:2}},axisLabel:{fontSize:13,fontWeight:"bold"},axisTick:{show:!0,lineStyle:{width:2}}}],series:[{name:"已选题目",type:"bar",data:l.selectedData,itemStyle:{normal:{barBorderRadius:3}}},{name:"全部题目",type:"bar",data:l.allData,markLine:{lineStyle:{normal:{type:"dashed"}}},itemStyle:{normal:{barBorderRadius:3}}}]},n={color:["#4c56e8","#72a2e8","#6084ee"],tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)",textStyle:{fontWeight:"bold",color:"#fff",fontSize:17}},legend:{orient:"vertical",x:"left",data:["简单类型","中等类型","困难类型"],textStyle:{color:"#4c56e8",fontWeight:"bold",fontSize:14}},series:[{name:"题目类型",type:"pie",radius:["50%","80%"],avoidLabelOverlap:!1,label:{normal:{show:!1,position:"center"},emphasis:{show:!0,textStyle:{fontSize:"30",fontWeight:"bold"}}},labelLine:{normal:{show:!1}},data:[{value:l.allData[0],name:"简单类型"},{value:l.allData[1],name:"中等类型"},{value:l.allData[2],name:"困难类型"}]}]};e.setOption(a),t.setOption(n)},setTimeout(function(){e.fn_showEcharts()},100),window.onresize=function(){window.location.reload()}}]);